# determination-of-the-odor-of-a-substance-by-its-structure-15.11-19.11

Этот проект направлен на предсказание характеристик запаха молекул по их структуре с использованием методов машинного обучения.

# Очистка исходных датасетов
Перед извлечением SMILES по Pubchem_ID мы сначала удалили отрицательные значения ID. Их было очень мало, поэтому на наборы данных это практически не повлияло

# Извлечение SMILES с использованием PubChemPy
Для сбора исходных химических данных мы использовали библиотеку PubChemPy, которая предоставляет удобный Python-интерфейс для работы с базой данных PubChem. Выбор этой библиотеки был обусловлен несколькими ключевыми преимуществами. PubChemPy значительно упрощает процесс получения химических данных по сравнению с прямыми HTTP-запросами к PubChem API. 

Библиотека обладает встроенными механизмами обработки ошибок и исключений, что позволяет надежно работать с большими наборами данных. PubChemPy поддерживает пакетную обработку запросов и автоматическое кэширование, что уменьшает нагрузку на серверы PubChem и ускоряет процесс сбора данных. Кроме того, библиотека обеспечивает простую интеграцию с pandas, позволяя легко создавать структурированные DataFrame с результатами запросов.

# Выбор молекулярных дескрипторов
Для характеристики молекулярных структур мы выбрали пакет Mordred, который предоставляет комплексный набор из более чем 1800 дескрипторов, охватывающих различные аспекты молекулярных свойств. Этот выбор был обусловлен необходимостью всестороннего описания молекул для задачи предсказания запаха.

Mordred вычисляет дескрипторы из нескольких ключевых категорий: топологические индексы, описывающие форму и связность молекулярного графа; геометрические дескрипторы, характеризующие пространственное строение; электронные свойства, включая распределение заряда и поляризуемость; а также дескрипторы, описывающие базовый состав молекулы. Такой комплексный подход позволяет захватывать различные аспекты, важные для взаимодействия молекул с обонятельными рецепторами.

Из полученных 1800 признаков было довольно большое количество коррелирующих, так что мы удалили те признаки, у которых коэффициент корреляции был >0.85. Итого у нас осталось 404 параметра. В дальнейшем мы их отсортировали по значимости для целевой переменной и пробовали брать разное количество лучших параметров. Наилучшую точность при обучении показали 155 признаков.

# Обучение модели
В процессе обучения были перепробованы самые различные варианты. Мы протестировали разные подходы: простые модели и перебор гиперпараметров для них, ансамбль из нескольких моделей и их дальнейшее голосование. Кроме того были опробованы методы балансировки классов, так как в исходных данных был значительный дизбаланс. Также мы протестировали методы иерархической классификации, так как почти любая модель очень хорошо отличает классы 0, 1, 5, 6 и 2, 3, 4, 7, но внутри групп возникают трудности с определением. 

В конечном итоге мы решили остановиться на модели Extra trees с лучшими гиперпараметрами, полученными в результате перебора. 
